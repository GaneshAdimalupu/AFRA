(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[284],{1244:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/scan",function(){return n(6973)}])},8281:function(e,t,n){"use strict";var o=n(5893);n(7294),n(1163),t.Z=e=>t=>{let checkAuth=async()=>{let e=await fetch("http://localhost/",{method:"GET",mode:"cors",headers:{"Content-Type":"application/json"},credentials:"include"}),t=await e.json();return t.isAdmin?{isLoggedIn:!0}:{isLoggedIn:!1}};return checkAuth().then(e=>{if(e.isLoggedIn)return null}),(0,o.jsx)(e,{...t})}},6973:function(e,t,n){"use strict";n.r(t);var o=n(5893),a=n(1664),s=n.n(a),l=n(7294),c=n(8281);t.default=(0,c.Z)(function(){let e=(0,l.useRef)(null),t=(0,l.useRef)(null),n=(0,l.useRef)(null),[a,c]=(0,l.useState)(""),[r,i]=(0,l.useState)(!1),[u,d]=(0,l.useState)(()=>""),getAttendance=async()=>{let e=await fetch("http://localhost/getAttendance",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:a}),credentials:"include"}),t=await e.json();console.log(t.url),d(()=>t.url.url.replaceAll('"',""))},handleClick=async()=>{stopCamera();let t=e.current.files[0],n=new FormData;n.append("code",a),n.append("file1",t);let o=await fetch("http://localhost/verify",{method:"POST",mode:"cors",headers:{},body:n,credentials:"include"}),s=await o.json();console.log(s);let l=[];if(200===o.status){console.log("jsh"),s.map(e=>{"unknown"!==e._label&&(l.push(e._label),console.log(l))});let e=await fetch("http://localhost/getStudents",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({usns:l}),credentials:"include"}),t=await e.json();console.log(t)}console.log({courseCode:a,imageFile:t})},startCamera=async()=>{let e=await navigator.mediaDevices.getUserMedia({video:!0});t.current.srcObject=e,await t.current.play();let o=n.current.getContext("2d");o.drawImage(t.current,0,0,n.current.width,n.current.height),i(!0)},stopCamera=()=>{let e=t.current.srcObject;e.getTracks().forEach(e=>e.stop()),i(!1)};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"flex flex-col items-center max-w-md mx-auto mt-10",children:[(0,o.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",ref:e,value:a,onChange:e=>c(e.target.value),placeholder:"Enter course code"}),(0,o.jsx)("button",{className:"bg-teal-500 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4",disabled:!a,onClick:getAttendance,children:"getAttendance"}),u?(0,o.jsx)(s(),{href:u,children:"ATTENDANCE SHEET"}):(0,o.jsx)(o.Fragment,{}),(0,o.jsx)("button",{className:"bg-teal-500 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4",disabled:!a,onClick:startCamera,children:"Start Camera"}),r&&(0,o.jsx)("button",{className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-4",onClick:handleClick,children:"Take Picture"}),(0,o.jsx)("video",{ref:t,className:"w-full h-auto mt-4",style:{objectFit:"cover"}}),(0,o.jsx)("canvas",{ref:n,style:{display:"none"}})]}),(0,o.jsx)("div",{className:"flex justify-center",children:(0,o.jsx)("input",{ref:e,className:"shadow appearance-none border rounded w-1/4 flex py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline bg-white",type:"file",name:"file1"})})]})})},1163:function(e,t,n){e.exports=n(9974)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1244)}),_N_E=e.O()}]);